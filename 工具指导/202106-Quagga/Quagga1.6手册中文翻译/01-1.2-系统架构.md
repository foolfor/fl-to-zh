## 1.2 系统架构

传统的路由软件是作为一个进程程序制作的，它提供了所有的路由协议功能。Quagga 采取了不同的方法。它由多个守护进程的集合组成，这些守护进程协同工作以构建路由表。可能有几个特定于协议的路由守护进程和 zebra 内核路由管理器。

该`ripd`守护进程处理RIP协议，而 `ospfd`是支持OSPF版本2守护程序 `bgpd`载体上的BGP-4协议。为了改变内核路由表和在不同路由协议之间重新分配路由，有一个内核路由表管理器`zebra`守护进程。在不影响任何其他软件的情况下，很容易向整个路由系统添加新的路由协议守护进程。您只需要运行与正在使用的路由协议相关的协议守护进程。因此，用户可以运行特定的守护进程并将路由报告发送到中央路由控制台。

这些守护进程不需要在同一台机器上运行。您甚至可以在同一台机器上运行多个相同的协议守护进程。这种架构为路由系统创造了新的可能性。

```shell
+----+  +----+  +-----+  +-----+
|bgpd|  |ripd|  |ospfd|  |zebra|
+----+  +----+  +-----+  +-----+
                            |
+---------------------------|--+
|                           v  |
|  UNIX Kernel  routing table  |
|                              |
+------------------------------+

    Quagga System Architecture
```

多进程架构带来可扩展性、模块化和可维护性。同时也带来了很多配置文件和终端接口。每个守护进程都有自己的配置文件和终端界面。配置静态路由时，必须在`zebra`配置文件中完成 。当您配置 BGP 网络时，它必须在`bgpd`配置文件中完成。这可能是一件非常烦人的事情。为了解决这个问题，Quagga 提供了名为`vtysh`. `vtysh`使用 UNIX 域套接字连接到每个守护进程，然后充当用户输入的代理。

Quagga 计划在使用支持多线程的内核运行时使用多线程机制。但是目前GNU /Linux或FreeBSD自带的线程库在运行路由软件等可靠服务方面存在一些问题，所以我们根本不使用线程。相反，我们使用`select(2)`系统调用来复用事件。